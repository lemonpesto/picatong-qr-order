<!-- 주문일시, 메뉴1이름, 메뉴1수량, 메뉴2이름, 메뉴2수량, ..., 결제금액  -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>피카통 오더</title>
    <link rel="stylesheet" href="/main.css" />
    <script src="https://kit.fontawesome.com/a3ff865f92.js" crossorigin="anonymous"></script>
  </head>
  <body>
    <%- include("nav.ejs") %>

    <div class="orders-container">
      <% if (orders && orders.length) { orders.forEach((order, idx) => { %>
      <div class="order-section">
        <!-- 아이템 카드 -->
        <div class="order-card">
          <!-- 섹션 헤더: 제목 + 시간 -->
          <div class="section-header">
            <span class="section-title"> <%= idx === 0 ? '최근 주문' : '이전 주문' %> </span>
            <span class="order-time" data-time="<%= new Date(order.requestedAt).getTime() %>"></span>
          </div>
          <% order.items.forEach(item => { %>
          <div class="order-item">
            <div class="left-item">
              <span class="item-name"> <%= item.menuName %> x<%= item.qty %> </span>
              <% if (item.comment) { %>
              <span class="subtext comment"><%= item.comment %></span>
              <% }%>
            </div>
            <span class="item-price"> <%= (item.price * item.qty).toLocaleString() %>원 </span>
          </div>
          <% }) %>
          <div class="order-footer">
            <span>합계</span>
            <span class="order-total"> <%= order.total.toLocaleString() %>원 </span>
          </div>
        </div>
      </div>
      <% }) } else { %>
      <p class="no-orders">주문 내역이 없습니다.</p>
      <% } %>
    </div>
  </body>
  <script>
    document.querySelectorAll(".order-time").forEach((span) => {
      const t = parseInt(span.dataset.time, 10);
      span.textContent = new Date(t).toLocaleTimeString("ko-KR", { hour: "2-digit", minute: "2-digit" });
    });
  </script>
</html>
